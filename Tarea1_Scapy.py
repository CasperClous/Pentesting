from scapy.all import *
x = 1
y = 65535
ip = "127.0.0.1"
src_port = RandShort()

for port in range(x, y):
    p = IP(dst=ip)/TCP(sport=src_port, dport=port, flags='S')
    resp = sr1(p, timeout=3, verbose=0)
    if str(type(resp)) == "<class 'NoneType'>":
        print(f"Puerto {port} Filtered")
    else:
        if resp.haslayer(TCP):
            if resp.getlayer(TCP).flags == 0x12:
                send_rst = sr(IP(dst=ip)/TCP(sport=src_port, dport=port, flags='AR'), timeout=1)
                print(f"Puerto {port} Abierto ")
            elif resp.getlayer(TCP).flags == 0x14:
                print(f"Puerto {port} Cerrado ")
print ("Scan Completo ")
